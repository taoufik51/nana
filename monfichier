New version of my code
